# <%= projectName %>

`This project was autogenerated using the Mephisto Yeoman template.`

## Introduction

This repository uses CDK to build your lambdas infrastructure in AWS, as well as the Lambda itself using TypeScript. The project is setup to use AWS SAM for locally runing your lambda. While you'd normally build a template.yaml file for using SAM, one of the interesting things about CDK is that it can generate one for you.

## Prerequisites

* CDK CLI - [Install the CDK CLI](https://docs.aws.amazon.com/cdk/latest/guide/cli.html)
* SAM CLI - [Install the SAM CLI](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html)
* Node.js - [Install Node.js 12x](https://nodejs.org/en/), including the NPM package management tool.
* Docker - [Install Docker community edition](https://hub.docker.com/search/?type=edition&offering=community)

## Project Structure

### Dependency Management

The project has one package.json file, you should add any dependencies you need for the CDK aspects or unit testing as devDependencies and modules you need for running your Lambda as dependencies. 


### Lambdas

ALthough this stack defines it's own API Gateway, it defines a `basePathMapping` to add that to an existing Custom Domain Name in Api gateway and make all the lambds for this prject available on a friendly URL stem.

Each Lambda must then be routed using this friendly URL stem as a base. By default since this project has one Lambda, it will use `/` as the stem but as you add more you'll need to thinking about routing so your Lambdas can be unique executed.

You should place your Lambdas as separately named TypeScript files in the src folder. You must also define them in the CDK stack in the `lib/<%= stackName %>-stack.ts` file. 

### Running locally with the SAM CLI

The following command will build your stack locally and spin up AWS SAM so you can execute your Lambda as a http endpoint running on port 3000.

```bash
$ npm run local
$ curl http://localhost:3000/
```

### Testing


### Deploying to AWS

If you have permissions to deploy to an AWS account for the CLI to deploy, run the following in your shell:

```bash
$ cdk deploy
```

## Useful commands

 * `npm run test`         perform the jest unit tests
 * `cdk deploy`           deploy this stack to your default AWS account/region
 * `cdk diff`             compare deployed stack with current state
 * `cdk synth`            emits the synthesized CloudFormation template

